<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NICO AI</title>

<style>
body{
  margin:0;
  font-family:Arial;
  background:#0f0f0f;
  color:#fff;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}
#box{
  width:90%;
  max-width:420px;
  background:#1c1c1c;
  border-radius:22px;
  padding:20px;
}
h2{text-align:center;}
input{
  width:100%;
  padding:14px;
  border-radius:30px;
  border:none;
  font-size:16px;
  margin-bottom:10px;
}
.buttons{
  display:flex;
  gap:10px;
}
button{
  flex:1;
  padding:14px;
  border-radius:30px;
  border:none;
  font-size:16px;
}
#mic{background:#2196f3;color:#fff;}
#send{background:#4caf50;color:#000;}
#reply{
  margin-top:15px;
  min-height:90px;
  background:#111;
  border-radius:15px;
  padding:12px;
}
</style>
</head>

<body>
<div id="box">
  <h2>ðŸ¤– Ù†ÙŠÙƒÙˆ</h2>
  <input id="input" placeholder="ØªØ­Ø¯Ø« Ø£Ùˆ Ø§ÙƒØªØ¨">
  <div class="buttons">
    <button id="mic" onclick="startListening()">ðŸŽ¤ Ù…Ø§ÙŠÙƒ</button>
    <button id="send" onclick="handleText()">ðŸ“© Ø¥Ø±Ø³Ø§Ù„</button>
  </div>
  <div id="reply">Ø£Ù†Ø§ Ø£ØªØ¹Ù„Ù… Ù…Ù†Ùƒâ€¦ ðŸ§ </div>
</div>

<script>
let memory = JSON.parse(localStorage.getItem("nicoMemory")) || {};
let lastQuestion = "";

function speak(text){
  let s = new SpeechSynthesisUtterance(text);
  s.lang = "ar-SA";
  speechSynthesis.speak(s);
}

function replyTo(text){
  text = text.trim().toLowerCase();
  let reply = "";

  // Ù„Ùˆ Ø§Ù„Ø³Ø¤Ø§Ù„ Ù…Ø­ÙÙˆØ¸
  if(memory[text]){
    reply = memory[text];
  }
  // ØªØ¹Ù„ÙŠÙ… Ù†ÙŠÙƒÙˆ
  else if(lastQuestion){
    memory[lastQuestion] = text;
    localStorage.setItem("nicoMemory", JSON.stringify(memory));
    reply = "ØªÙ…Ø§Ù… ðŸ‘ ØªØ¹Ù„Ù…Øª Ù‡Ø°Ø§ Ø§Ù„Ø±Ø¯";
    lastQuestion = "";
  }
  else{
    reply = "Ù„Ø§ Ø£Ø¹Ø±Ù Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©ØŒ Ø¹Ù„Ù‘Ù…Ù†ÙŠ ðŸ˜„";
    lastQuestion = text;
  }

  document.getElementById("reply").innerText = reply;
  speak(reply);
}

function handleText(){
  let t = document.getElementById("input").value;
  if(t) replyTo(t);
}

function startListening(){
  let SR = window.SpeechRecognition || window.webkitSpeechRecognition;
  let rec = new SR();
  rec.lang = "ar-SA";
  rec.onresult = e=>{
    let text = e.results[0][0].transcript;
    document.getElementById("input").value = text;
    replyTo(text);
  };
  rec.start();
}
</script>
</body>
</html>
